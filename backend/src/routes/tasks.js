import express from 'express';import Task from '../models/Task.js';import auth from '../middleware/auth.js';const r=express.Router();r.use(auth);r.get('/',async(req,res)=>{res.json(await Task.find({userId:req.user.id}).sort({updatedAt:-1}))});r.post('/',async(req,res)=>{const {title}=req.body;if(!title)return res.status(400).json({error:'Title required'});res.json(await Task.create({userId:req.user.id,title}))});r.patch('/:id',async(req,res)=>{const {title,done}=req.body;const t=await Task.findOne({_id:req.params.id,userId:req.user.id});if(!t)return res.status(404).json({error:'Not found'});if(title!==undefined)t.title=title;if(done!==undefined)t.done=!!done;await t.save();res.json(t)});r.delete('/:id',async(req,res)=>{await Task.deleteOne({_id:req.params.id,userId:req.user.id});res.json({ok:true})});export default r
